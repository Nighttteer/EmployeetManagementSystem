# æ‰‹æœºå·ç™»å½•ä¿®æ”¹æ–‡æ¡£

## ğŸ“± ä¿®æ”¹æ¦‚è¿°
å°†ç”¨æˆ·ç™»å½•æ–¹å¼ä»é‚®ç®±æ”¹ä¸ºæ‰‹æœºå·ï¼Œç”¨æˆ·ç°åœ¨å¯ä»¥ä½¿ç”¨æ‰‹æœºå·ä½œä¸ºç”¨æˆ·åç™»å½•ç³»ç»Ÿã€‚

## ğŸ”§ ä¿®æ”¹å†…å®¹

### åç«¯ä¿®æ”¹

#### 1. ä¿®æ”¹ç™»å½•åºåˆ—åŒ–å™¨ (`accounts/serializers.py`)
- **æ–‡ä»¶**: `chronic-disease-backend/accounts/serializers.py`
- **ä¿®æ”¹**: `UserLoginSerializer` ç±»
- **å˜æ›´**:
  - å°† `email` å­—æ®µæ”¹ä¸º `phone` å­—æ®µ
  - æ·»åŠ æ‰‹æœºå·æ ¼å¼éªŒè¯
  - ä¿®æ”¹ç”¨æˆ·æŸ¥æ‰¾é€»è¾‘ï¼Œä½¿ç”¨ `User.objects.get(phone=phone)` è€Œä¸æ˜¯ `authenticate()`
  - æ·»åŠ å¯†ç éªŒè¯é€»è¾‘ `user.check_password(password)`

#### 2. ä¿®æ”¹æµ‹è¯•æ–‡ä»¶ (`test_api.py`)
- **æ–‡ä»¶**: `chronic-disease-backend/test_api.py`
- **ä¿®æ”¹**: `test_user_login()` å‡½æ•°
- **å˜æ›´**:
  - å°†ç™»å½•æ•°æ®ä¸­çš„ `email` æ”¹ä¸º `phone`
  - ä½¿ç”¨æ‰‹æœºå· `+8613800138000` è¿›è¡Œæµ‹è¯•

#### 3. åˆ›å»ºæµ‹è¯•ç”¨æˆ·æ•°æ®è„šæœ¬
- **æ–‡ä»¶**: `chronic-disease-backend/create_test_users.py`
- **åŠŸèƒ½**: åˆ›å»ºæµ‹è¯•ç”¨æˆ·æ•°æ®
- **å†…å®¹**:
  - åˆ›å»ºæµ‹è¯•æ‚£è€…ï¼šæ‰‹æœºå· `+8613800138000`
  - åˆ›å»ºæµ‹è¯•åŒ»ç”Ÿï¼šæ‰‹æœºå· `+8613800138001`
  - å¯†ç ç»Ÿä¸€ä¸º `testpass123`

### å‰ç«¯ä¿®æ”¹

#### 1. ä¿®æ”¹ç™»å½•ç•Œé¢ (`LoginScreen.js`)
- **æ–‡ä»¶**: `chronic-disease-app/src/screens/auth/LoginScreen.js`
- **ä¿®æ”¹**: ç™»å½•è¡¨å•
- **å˜æ›´**:
  - å°† `username` å­—æ®µæ”¹ä¸º `phone` å­—æ®µ
  - ä¿®æ”¹è¾“å…¥æ¡†æ ‡ç­¾ä¸º "æ‰‹æœºå·"
  - æ·»åŠ æ‰‹æœºå·è¾“å…¥é”®ç›˜ç±»å‹ `keyboardType="phone-pad"`
  - æ·»åŠ å ä½ç¬¦æç¤ºç”¨æˆ·è¾“å…¥æ ¼å¼
  - ä¿®æ”¹å›¾æ ‡ä¸ºæ‰‹æœºå›¾æ ‡
  - æ›´æ–°éªŒè¯æç¤ºä¿¡æ¯

#### 2. ä¿®æ”¹ReduxçŠ¶æ€ç®¡ç† (`authSlice.js`)
- **æ–‡ä»¶**: `chronic-disease-app/src/store/slices/authSlice.js`
- **ä¿®æ”¹**: `loginUser` å¼‚æ­¥action
- **å˜æ›´**:
  - å°†å‚æ•°ä» `{username, password}` æ”¹ä¸º `{phone, password, userType}`
  - ä¿®æ”¹APIè°ƒç”¨ä¼ é€’æ‰‹æœºå·å’Œè§’è‰²å‚æ•°
  - æ›´æ–°tokenå’Œç”¨æˆ·æ•°æ®å¤„ç†é€»è¾‘

#### 3. ä¿®æ”¹APIæœåŠ¡ (`api.js`)
- **æ–‡ä»¶**: `chronic-disease-app/src/services/api.js`
- **ä¿®æ”¹**: `authAPI.login` å‡½æ•°
- **å˜æ›´**:
  - å‚æ•°ä» `(username, password)` æ”¹ä¸º `(phone, password, role)`
  - ä¿®æ”¹è¯·æ±‚ä½“æ•°æ®ç»“æ„

## ğŸ“‹ æµ‹è¯•ç”¨æˆ·ä¿¡æ¯

### æ‚£è€…è´¦æˆ·
- **æ‰‹æœºå·**: `+8613800138000`
- **å¯†ç **: `testpass123`
- **è§’è‰²**: æ‚£è€… (patient)
- **å§“å**: æµ‹è¯•æ‚£è€…

### åŒ»ç”Ÿè´¦æˆ·
- **æ‰‹æœºå·**: `+8613800138001`
- **å¯†ç **: `testpass123`
- **è§’è‰²**: åŒ»ç”Ÿ (doctor)
- **å§“å**: æµ‹è¯•åŒ»ç”Ÿ

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### åˆ›å»ºæµ‹è¯•ç”¨æˆ·
```bash
cd chronic-disease-backend
python create_test_users.py
```

### ç™»å½•æµ‹è¯•
1. å¯åŠ¨åç«¯æœåŠ¡: `python manage.py runserver`
2. å¯åŠ¨å‰ç«¯åº”ç”¨: `npm start` (åœ¨ chronic-disease-app ç›®å½•)
3. åœ¨ç™»å½•ç•Œé¢è¾“å…¥æ‰‹æœºå·å’Œå¯†ç 

### APIæµ‹è¯•
```bash
cd chronic-disease-backend
python test_api.py
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **æ‰‹æœºå·æ ¼å¼**: å¿…é¡»åŒ…å«å›½å®¶åŒºå·ï¼Œä»¥ `+` å¼€å¤´
2. **è§’è‰²éªŒè¯**: ç™»å½•æ—¶ä¼šéªŒè¯ç”¨æˆ·è§’è‰²æ˜¯å¦åŒ¹é…
3. **æ•°æ®åº“**: ç¡®ä¿æ•°æ®åº“ä¸­çš„ç”¨æˆ·æœ‰æ­£ç¡®çš„æ‰‹æœºå·å­—æ®µ
4. **å‘åå…¼å®¹**: ç°æœ‰ç”¨æˆ·éœ€è¦æ·»åŠ æ‰‹æœºå·å­—æ®µæ‰èƒ½ç™»å½•

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°é‚®ç®±ç™»å½•ï¼Œéœ€è¦ï¼š
1. æ¢å¤ `UserLoginSerializer` ä½¿ç”¨é‚®ç®±è®¤è¯
2. æ¢å¤å‰ç«¯ç™»å½•ç•Œé¢ä½¿ç”¨é‚®ç®±å­—æ®µ
3. æ¢å¤APIè°ƒç”¨å‚æ•°
4. æ¢å¤æµ‹è¯•æ•°æ®

## âœ… éªŒè¯æ¸…å•

- [ ] åç«¯ç™»å½•APIæ”¯æŒæ‰‹æœºå·
- [ ] å‰ç«¯ç™»å½•ç•Œé¢æ˜¾ç¤ºæ‰‹æœºå·è¾“å…¥
- [ ] æ‰‹æœºå·æ ¼å¼éªŒè¯æ­£å¸¸
- [ ] è§’è‰²éªŒè¯æ­£å¸¸
- [ ] æµ‹è¯•ç”¨æˆ·å¯ä»¥æ­£å¸¸ç™»å½•
- [ ] APIæµ‹è¯•é€šè¿‡
- [ ] æ‚£è€…å’ŒåŒ»ç”Ÿè§’è‰²éƒ½å¯ä»¥æ­£å¸¸ç™»å½• 